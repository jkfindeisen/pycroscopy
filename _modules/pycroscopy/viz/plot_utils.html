

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pycroscopy.viz.plot_utils &mdash; pycroscopy 0.59.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/gallery.css" type="text/css" />
  

  
        <link rel="author" title="About these documents"
              href="../../../about.html"/>
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="pycroscopy 0.59.2 documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> pycroscopy
          

          
          </a>

          
            
            
              <div class="version">
                0.59.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about.html">Pycroscopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../whats_new.html">Whatâ€™s New</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_format.html">Pycroscopy Data and File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../papers_conferences.html">Papers / Conferences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/index.html">Examples &amp; Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/index.html#scientific-data-analysis">Scientific Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/index.html#developer-tutorials">Developer Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/index.html#user-tutorials">User Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contact.html">Contact us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pycroscopy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>pycroscopy.viz.plot_utils</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pycroscopy.viz.plot_utils</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Thu May 05 13:29:12 2016</span>

<span class="sd">@author: Suhas Somnath</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># TODO: All general plotting functions should support data with 1, 2, or 3 spatial dimensions.</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">unicode_literals</span>

<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="k">import</span> <span class="n">warn</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">h5py</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="k">import</span> <span class="n">blackman</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="k">import</span> <span class="n">LinearSegmentedColormap</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">ImageGrid</span>
<span class="kn">from</span> <span class="nn">..io.hdf_utils</span> <span class="k">import</span> <span class="n">reshape_to_Ndims</span><span class="p">,</span> <span class="n">get_formatted_labels</span><span class="p">,</span> <span class="n">get_data_descriptor</span>

<span class="c1"># mpl.rcParams.keys()  # gets all allowable keys</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> <span class="c1"># global font size</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick.major&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick.minor&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="c1"># mpl.rcParams[&#39;xtick.major.size&#39;] = 6</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
    <span class="n">unicode</span> <span class="o">=</span> <span class="nb">str</span>

<span class="n">default_cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span>

<div class="viewcode-block" id="set_tick_font_size"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.set_tick_font_size">[docs]</a><span class="k">def</span> <span class="nf">set_tick_font_size</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">font_size</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the font size of the ticks in the provided axes</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axes : matplotlib.pyplot.axis object or list of axis objects</span>
<span class="sd">        axes to set font sizes</span>
<span class="sd">    font_size : unigned int</span>
<span class="sd">        Font size</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__set_axis_tick</span><span class="p">(</span><span class="n">axis</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the font sizes to the x and y axis in the given axis object</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : matplotlib.pyplot.axis object</span>
<span class="sd">            axis to set font sizes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">axis</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">axis</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
            <span class="n">__set_axis_tick</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">__set_axis_tick</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span></div>


<div class="viewcode-block" id="make_scalar_mappable"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.make_scalar_mappable">[docs]</a><span class="k">def</span> <span class="nf">make_scalar_mappable</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a scalar mappable object that can be used to create a colorbar for non-image (e.g. - line) plots</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    vmin : float</span>
<span class="sd">        Minimum value for colorbar</span>
<span class="sd">    vmax : float</span>
<span class="sd">        Maximum value for colorbar</span>
<span class="sd">    cmap : colormap object</span>
<span class="sd">        Colormap object to use</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sm : matplotlib.pyplot.cm.ScalarMappable object</span>
<span class="sd">        The object that can used to create a colorbar via plt.colorbar(sm)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">default_cmap</span>

    <span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                               <span class="n">norm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">))</span>
    <span class="c1"># fake up the array of the scalar mappable</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">return</span> <span class="n">sm</span></div>


<div class="viewcode-block" id="get_cmap_object"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.get_cmap_object">[docs]</a><span class="k">def</span> <span class="nf">get_cmap_object</span><span class="p">(</span><span class="n">cmap</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the matplotlib.colors.LinearSegmentedColormap object regardless of the input</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cmap : String, or matplotlib.colors.LinearSegmentedColormap object (Optional)</span>
<span class="sd">        Requested color map</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cmap : matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        Requested / Default colormap object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">default_cmap</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cmap</span></div>


<div class="viewcode-block" id="cmap_jet_white_center"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.cmap_jet_white_center">[docs]</a><span class="k">def</span> <span class="nf">cmap_jet_white_center</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates the jet colormap with a white center</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    white_jet : matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        color map object that can be used in place of the default colormap</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># For red - central column is like brightness</span>
    <span class="c1"># For blue - last column is like brightness</span>
    <span class="n">cdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                     <span class="p">(</span><span class="mf">0.30</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                     <span class="p">(</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                     <span class="p">(</span><span class="mf">0.90</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                     <span class="p">(</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)),</span>
             <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                       <span class="p">(</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                       <span class="p">(</span><span class="mf">0.42</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                       <span class="p">(</span><span class="mf">0.58</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                       <span class="p">(</span><span class="mf">0.90</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                       <span class="p">(</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span>
             <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                      <span class="p">(</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                      <span class="p">(</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                      <span class="p">(</span><span class="mf">0.70</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                      <span class="p">(</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
             <span class="p">}</span>
    <span class="k">return</span> <span class="n">LinearSegmentedColormap</span><span class="p">(</span><span class="s1">&#39;white_jet&#39;</span><span class="p">,</span> <span class="n">cdict</span><span class="p">)</span></div>

<div class="viewcode-block" id="cmap_from_rgba"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.cmap_from_rgba">[docs]</a><span class="k">def</span> <span class="nf">cmap_from_rgba</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">interp_vals</span><span class="p">,</span> <span class="n">normalization_val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a colormap given a matlab-style interpolation table</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : String / Unicode</span>
<span class="sd">        Name of the desired colormap</span>
<span class="sd">    interp_vals : List of tuples</span>
<span class="sd">        Interpolation table that describes the desired color map. Each entry in the table should be described as:</span>
<span class="sd">        (position in the colorbar, (red, green, blue, alpha))</span>
<span class="sd">        The position in the color bar, red, green, blue, and alpha vary from 0 to the normalization value</span>
<span class="sd">    normalization_val : number</span>
<span class="sd">        The common maximum value for the position in the color bar, red, green, blue, and alpha</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_cmap : matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        desired color map</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">normalization_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">normalization_val</span><span class="p">)</span>

    <span class="n">cdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">([(</span><span class="n">dist</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">)</span>
                           <span class="k">for</span> <span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span> <span class="ow">in</span> <span class="n">interp_vals</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
             <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">([(</span><span class="n">dist</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">)</span>
                             <span class="k">for</span> <span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span> <span class="ow">in</span> <span class="n">interp_vals</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
             <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">([(</span><span class="n">dist</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">)</span>
                            <span class="k">for</span> <span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span> <span class="ow">in</span> <span class="n">interp_vals</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
             <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">([(</span><span class="n">dist</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="n">normalization_val</span><span class="p">)</span>
                             <span class="k">for</span> <span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span> <span class="ow">in</span> <span class="n">interp_vals</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])}</span>

    <span class="k">return</span> <span class="n">LinearSegmentedColormap</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">cdict</span><span class="p">)</span></div>


<div class="viewcode-block" id="make_linear_alpha_cmap"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.make_linear_alpha_cmap">[docs]</a><span class="k">def</span> <span class="nf">make_linear_alpha_cmap</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">solid_color</span><span class="p">,</span> <span class="n">normalization_val</span><span class="p">,</span> <span class="n">min_alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a transparent to opaque color map based on a single solid color</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : String / Unicode</span>
<span class="sd">        Name of the desired colormap</span>
<span class="sd">    solid_color : List of numbers</span>
<span class="sd">        red, green, blue, and alpha values for a specific color</span>
<span class="sd">    normalization_val : number</span>
<span class="sd">        The common maximum value for the red, green, blue, and alpha values. This is 1 in matplotlib</span>
<span class="sd">    min_alpha : float (optional. Default = 0 : ie- transparent)</span>
<span class="sd">        Lowest alpha value for the bottom of the color bar</span>
<span class="sd">    max_alpha : float (optional. Default = 1 : ie- opaque)</span>
<span class="sd">        Highest alpha value for the top of the color bar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_cmap : matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        transparent to opaque color map based on the provided color</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solid_color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">solid_color</span><span class="p">)</span> <span class="o">/</span> <span class="n">normalization_val</span> <span class="o">*</span> <span class="mf">1.0</span>
    <span class="n">interp_table</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="n">solid_color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">solid_color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">solid_color</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">max_alpha</span><span class="p">)),</span>
                    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">solid_color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">solid_color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">solid_color</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">min_alpha</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">cmap_from_rgba</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">interp_table</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="cmap_hot_desaturated"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.cmap_hot_desaturated">[docs]</a><span class="k">def</span> <span class="nf">cmap_hot_desaturated</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a desaturated color map based on the hot colormap</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_cmap : matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        Desaturated version of the hot color map</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hot_desaturated</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">255.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                       <span class="p">(</span><span class="mf">218.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">107</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                       <span class="p">(</span><span class="mf">182.1</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                       <span class="p">(</span><span class="mf">145.6</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                       <span class="p">(</span><span class="mf">109.4</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                       <span class="p">(</span><span class="mf">72.675</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                       <span class="p">(</span><span class="mf">36.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                       <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">71</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">255</span><span class="p">))]</span>

    <span class="k">return</span> <span class="n">cmap_from_rgba</span><span class="p">(</span><span class="s1">&#39;hot_desaturated&#39;</span><span class="p">,</span> <span class="n">hot_desaturated</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span></div>


<div class="viewcode-block" id="discrete_cmap"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.discrete_cmap">[docs]</a><span class="k">def</span> <span class="nf">discrete_cmap</span><span class="p">(</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">base_cmap</span><span class="o">=</span><span class="n">default_cmap</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an N-bin discrete colormap from the specified input map</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    num_bins : unsigned int</span>
<span class="sd">        Number of discrete bins</span>
<span class="sd">    base_cmap : matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        Base color map to discretize</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_cmap : String or matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        Discretized color map</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Jake VanderPlas License: BSD-style</span>
<span class="sd">    https://gist.github.com/jakevdp/91077b0cae40f8f8244a</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">base_cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">base_cmap</span> <span class="o">=</span> <span class="n">default_cmap</span><span class="o">.</span><span class="n">name</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_cmap</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">default_cmap</span><span class="p">)):</span>
        <span class="n">base_cmap</span> <span class="o">=</span> <span class="n">base_cmap</span><span class="o">.</span><span class="n">name</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">base_cmap</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">base_cmap</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">base_cmap</span></div>


<span class="k">def</span> <span class="nf">_add_loop_parameters</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">switching_coef_vec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add the loop parameters for the given loop to a list of axes</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axes : list of matplotlib.pyplo.axes</span>
<span class="sd">        Plot axes to add the coeffients to</span>
<span class="sd">    switching_coef_vec : 1D numpy.ndarray</span>
<span class="sd">        Array of loop parameters arranged by position</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    axes : list of matplotlib.pyplo.axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">switching_coef_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">positions</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">switching_coef_vec</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="s1">&#39;V+&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;V+&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">switching_coef_vec</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="s1">&#39;V-&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;V-&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">switching_coef_vec</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="s1">&#39;Nucleation Bias 1&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nucleation Bias 1&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">switching_coef_vec</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="s1">&#39;Nucleation Bias 2&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nucleation Bias 2&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">switching_coef_vec</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="s1">&#39;R+&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R+&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">switching_coef_vec</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="s1">&#39;R-&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R-&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">axes</span>


<div class="viewcode-block" id="rainbow_plot"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.rainbow_plot">[docs]</a><span class="k">def</span> <span class="nf">rainbow_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ao_vec</span><span class="p">,</span> <span class="n">ai_vec</span><span class="p">,</span> <span class="n">num_steps</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">default_cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the input against the output waveform (typically loops).</span>
<span class="sd">    The color of the curve changes as a function of time using the jet colorscheme</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : axis handle</span>
<span class="sd">        Axis to plot the curve</span>
<span class="sd">    ao_vec : 1D float numpy array</span>
<span class="sd">        vector that forms the X axis</span>
<span class="sd">    ai_vec : 1D float numpy array</span>
<span class="sd">        vector that forms the Y axis</span>
<span class="sd">    num_steps : unsigned int (Optional)</span>
<span class="sd">        Number of discrete color steps</span>
<span class="sd">    cmap : matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        Colormap to be used</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap_object</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>

    <span class="n">pts_per_step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ai_vec</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_steps</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_steps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ao_vec</span><span class="p">[</span><span class="n">step</span> <span class="o">*</span> <span class="n">pts_per_step</span><span class="p">:(</span><span class="n">step</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">pts_per_step</span><span class="p">],</span>
                <span class="n">ai_vec</span><span class="p">[</span><span class="n">step</span> <span class="o">*</span> <span class="n">pts_per_step</span><span class="p">:(</span><span class="n">step</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">pts_per_step</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">step</span> <span class="o">/</span> <span class="n">num_steps</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># plot the remainder:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ao_vec</span><span class="p">[(</span><span class="n">num_steps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">pts_per_step</span><span class="p">:],</span>
            <span class="n">ai_vec</span><span class="p">[(</span><span class="n">num_steps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">pts_per_step</span><span class="p">:],</span>
            <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">num_steps</span> <span class="o">/</span> <span class="n">num_steps</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CS3=plt.contourf([[0,0],[0,0]], range(0,310),cmap=plt.cm.viridis)</span>
<span class="sd">    fig.colorbar(CS3)&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="plot_line_family"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plot_line_family">[docs]</a><span class="k">def</span> <span class="nf">plot_line_family</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">x_axis</span><span class="p">,</span> <span class="n">line_family</span><span class="p">,</span> <span class="n">line_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label_prefix</span><span class="o">=</span><span class="s1">&#39;Line&#39;</span><span class="p">,</span> <span class="n">label_suffix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                     <span class="n">cmap</span><span class="o">=</span><span class="n">default_cmap</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a family of lines with a sequence of colors</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis : axis handle</span>
<span class="sd">        Axis to plot the curve</span>
<span class="sd">    x_axis : array-like</span>
<span class="sd">        Values to plot against</span>
<span class="sd">    line_family : 2D numpy array</span>
<span class="sd">        family of curves arranged as [curve_index, features]</span>
<span class="sd">    line_names : array-like</span>
<span class="sd">        array of string or numbers that represent the identity of each curve in the family</span>
<span class="sd">    label_prefix : string / unicode</span>
<span class="sd">        prefix for the legend (before the index of the curve)</span>
<span class="sd">    label_suffix : string / unicode</span>
<span class="sd">        suffix for the legend (after the index of the curve)</span>
<span class="sd">    cmap : matplotlib.colors.LinearSegmentedColormap object</span>
<span class="sd">        Colormap to be used</span>
<span class="sd">    y_offset : (optional) number</span>
<span class="sd">        quantity by which the lines are offset from each other vertically (useful for spectra)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap_object</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>

    <span class="n">num_lines</span> <span class="o">=</span> <span class="n">line_family</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">line_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">line_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label_prefix</span><span class="p">,</span> <span class="n">line_ind</span><span class="p">,</span> <span class="n">label_suffix</span><span class="p">)</span> <span class="k">for</span> <span class="n">line_ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_lines</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_names</span><span class="p">)</span> <span class="o">!=</span> <span class="n">num_lines</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Line names of different length compared to provided dataset&#39;</span><span class="p">)</span>
            <span class="n">line_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label_prefix</span><span class="p">,</span> <span class="n">line_ind</span><span class="p">,</span> <span class="n">label_suffix</span><span class="p">)</span> <span class="k">for</span> <span class="n">line_ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_lines</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">line_ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_lines</span><span class="p">):</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">line_family</span><span class="p">[</span><span class="n">line_ind</span><span class="p">]</span> <span class="o">+</span> <span class="n">line_ind</span> <span class="o">*</span> <span class="n">y_offset</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="n">line_names</span><span class="p">[</span><span class="n">line_ind</span><span class="p">],</span>
                  <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">line_ind</span> <span class="o">/</span> <span class="p">(</span><span class="n">num_lines</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_map"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plot_map">[docs]</a><span class="k">def</span> <span class="nf">plot_map</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">stdevs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a 2d map with a tight z axis, with or without color bars.</span>
<span class="sd">    Note that the direction of the y axis is flipped if the color bar is required</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis : matplotlib.pyplot.axis object</span>
<span class="sd">        Axis to plot this map onto</span>
<span class="sd">    data : 2D real numpy array</span>
<span class="sd">        Data to be plotted</span>
<span class="sd">    stdevs : unsigned int (Optional. Default = None)</span>
<span class="sd">        Number of standard deviations to consider for plotting.  If None, full range is plotted.</span>
<span class="sd">    origin : str</span>
<span class="sd">        Where should the origin of the image data be located.  &#39;lower&#39; sets the origin to the</span>
<span class="sd">        bottom left, &#39;upper&#39; sets it to the upper left.</span>
<span class="sd">        Default &#39;lower&#39;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">stdevs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">data_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">plt_min</span> <span class="o">=</span> <span class="n">data_mean</span> <span class="o">-</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">data_std</span>
        <span class="n">plt_max</span> <span class="o">=</span> <span class="n">data_mean</span> <span class="o">+</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">data_std</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">plt_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                     <span class="n">vmin</span><span class="o">=</span><span class="n">plt_min</span><span class="p">,</span>
                     <span class="n">vmax</span><span class="o">=</span><span class="n">plt_max</span><span class="p">,</span>
                     <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">im</span></div>


<div class="viewcode-block" id="single_img_cbar_plot"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.single_img_cbar_plot">[docs]</a><span class="k">def</span> <span class="nf">single_img_cbar_plot</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">show_xy_ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_ticks</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                         <span class="n">cbar_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots an image within the given axis with a color bar + label and appropriate X, Y tick labels.</span>
<span class="sd">    This is particularly useful to get readily interpretable plots for papers</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis : matplotlib.axis object</span>
<span class="sd">        Axis to plot this image onto</span>
<span class="sd">    img : 2D numpy array with real values</span>
<span class="sd">        Data for the image plot</span>
<span class="sd">    show_xy_ticks : bool, Optional, default = None, shown unedited</span>
<span class="sd">        Whether or not to show X, Y ticks</span>
<span class="sd">    show_cbar : bool, optional, default = True</span>
<span class="sd">        Whether or not to show the colorbar</span>
<span class="sd">    x_size : float, optional, default = 1</span>
<span class="sd">        Extent of tick marks in the X axis. This could be something like 1.5 for 1.5 microns</span>
<span class="sd">    y_size : float, optional, default = 1</span>
<span class="sd">        Extent of tick marks in y axis</span>
<span class="sd">    num_ticks : unsigned int, optional, default = 4</span>
<span class="sd">        Number of tick marks on the X and Y axes</span>
<span class="sd">    cbar_label : str, optional, default = None</span>
<span class="sd">        Labels for the colorbar. Use this for something like quantity (units)</span>
<span class="sd">    tick_font_size : unsigned int, optional, default = 14</span>
<span class="sd">        Font size to apply to x, y, colorbar ticks and colorbar label</span>
<span class="sd">    kwargs : dictionary</span>
<span class="sd">        Anything else that will be passed on to plot_map or imshow</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    im_handle : handle to image plot</span>
<span class="sd">        handle to image plot</span>
<span class="sd">    cbar : handle to color bar</span>
<span class="sd">        handle to color bar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;clim&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">im_handle</span> <span class="o">=</span> <span class="n">plot_map</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">im_handle</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_xy_ticks</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">x_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_ticks</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_ticks</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x_ticks</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_ticks</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ind</span> <span class="o">*</span> <span class="n">x_size</span> <span class="o">/</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">x_ticks</span><span class="p">])</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ind</span> <span class="o">*</span> <span class="n">y_size</span> <span class="o">/</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">])</span>
        <span class="n">set_tick_font_size</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">show_xy_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">set_tick_font_size</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="p">)</span>

    <span class="n">cbar</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">show_cbar</span><span class="p">:</span>
        <span class="c1"># cbar = fig.colorbar(im_handle, ax=axis)</span>
        <span class="c1"># divider = make_axes_locatable(axis)</span>
        <span class="c1"># cax = divider.append_axes(&#39;right&#39;, size=&#39;5%&#39;, pad=0.05)</span>
        <span class="c1"># cbar = plt.colorbar(im_handle, cax=cax)</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im_handle</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                            <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">use_gridspec</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cbar_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">cbar_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">tick_font_size</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        z_lims = cbar.get_clim()</span>
<span class="sd">        cbar.set_ticks(np.linspace(z_lims[0],z_lims[1], num_ticks))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">tick_font_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">im_handle</span><span class="p">,</span> <span class="n">cbar</span></div>


<div class="viewcode-block" id="plot_loops"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plot_loops">[docs]</a><span class="k">def</span> <span class="nf">plot_loops</span><span class="p">(</span><span class="n">excit_wfm</span><span class="p">,</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">line_colors</span><span class="o">=</span><span class="p">[],</span> <span class="n">dataset_names</span><span class="o">=</span><span class="p">[],</span> <span class="n">evenly_spaced</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">plots_on_side</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">subtitles</span><span class="o">=</span><span class="s1">&#39;Position&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
               <span class="n">central_resp_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_rainbow_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">h5_pos</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># TODO: Allow multiple excitation waveforms</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots loops from multiple datasets from up to 25 evenly spaced positions</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    excit_wfm : 1D numpy float array</span>
<span class="sd">        Excitation waveform in the time domain</span>
<span class="sd">    datasets : list of 2D numpy arrays or 2D hyp5.Dataset objects</span>
<span class="sd">        Datasets containing data arranged as (pixel, time)</span>
<span class="sd">    line_colors : list of strings</span>
<span class="sd">        Colors to be used for each of the datasets</span>
<span class="sd">    dataset_names : (Optional) list of strings</span>
<span class="sd">        Names of the different datasets to be compared</span>
<span class="sd">    h5_pos : HDF5 dataset reference or 2D numpy array</span>
<span class="sd">        Dataset containing position indices</span>
<span class="sd">    central_resp_size : (optional) unsigned integer</span>
<span class="sd">        Number of responce sample points from the center of the waveform to show in plots. Useful for SPORC</span>
<span class="sd">    evenly_spaced : boolean</span>
<span class="sd">        Evenly spaced positions or first N positions</span>
<span class="sd">    plots_on_side : unsigned int</span>
<span class="sd">        Number of plots on each side</span>
<span class="sd">    use_rainbow_plots : (optional) Boolean</span>
<span class="sd">        Plot the lines as a function of spectral index (eg. time)</span>
<span class="sd">    x_label : (optional) String</span>
<span class="sd">        X Label for all plots</span>
<span class="sd">    y_label : (optional) String</span>
<span class="sd">        Y label for all plots</span>
<span class="sd">    subtitles : (optional) String</span>
<span class="sd">        prefix for title over each plot</span>
<span class="sd">    title : (optional) String</span>
<span class="sd">        Main plot title</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    fig, axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
        <span class="c1"># can be numpy array or h5py.dataset</span>
        <span class="n">num_pos</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">num_points</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">datasets</span><span class="p">]</span>
        <span class="n">line_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
        <span class="n">dataset_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Default&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># First check if the datasets are correctly shaped:</span>
        <span class="n">num_pos_es</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">num_points_es</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
            <span class="n">num_pos_es</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">num_points_es</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">num_pos_es</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">num_pos_es</span><span class="p">)</span>
        <span class="n">num_points_es</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">num_points_es</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">num_pos_es</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">num_points_es</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Datasets of incompatible sizes&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">num_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">num_pos_es</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">num_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">num_points_es</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Next the identification of datasets:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">):</span>
            <span class="c1"># remove additional titles</span>
            <span class="n">dataset_names</span> <span class="o">=</span> <span class="n">dataset_names</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_names</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">):</span>
            <span class="c1"># add titles</span>
            <span class="n">dataset_names</span> <span class="o">=</span> <span class="n">dataset_names</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Dataset&#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset_names</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">))]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_colors</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">):</span>
            <span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;pink&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">color_list</span><span class="p">):</span>
                <span class="n">remaining_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">color_list</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">line_colors</span><span class="p">]</span>
                <span class="n">line_colors</span> <span class="o">+=</span> <span class="n">remaining_colors</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">color_list</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Insufficient number of line colors provided&#39;</span><span class="p">)</span>
                <span class="k">return</span>

    <span class="k">if</span> <span class="n">excit_wfm</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">num_points</span><span class="p">:</span>
        <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Length of excitation waveform not compatible with second axis of datasets&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">plots_on_side</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">plots_on_side</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>

    <span class="n">sq_num_plots</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">plots_on_side</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">num_pos</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">evenly_spaced</span><span class="p">:</span>
        <span class="n">chosen_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_pos</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sq_num_plots</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">chosen_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sq_num_plots</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">sq_num_plots</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">sq_num_plots</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">axes_lin</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="n">cent_ind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">excit_wfm</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">central_resp_size</span><span class="p">:</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">central_resp_size</span><span class="p">)</span>
        <span class="n">l_resp_ind</span> <span class="o">=</span> <span class="n">cent_ind</span> <span class="o">-</span> <span class="n">sz</span>
        <span class="n">r_resp_ind</span> <span class="o">=</span> <span class="n">cent_ind</span> <span class="o">+</span> <span class="n">sz</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">l_resp_ind</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">r_resp_ind</span> <span class="o">=</span> <span class="n">excit_wfm</span><span class="o">.</span><span class="n">size</span>

    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">posn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chosen_pos</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">use_rainbow_plots</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rainbow_plot</span><span class="p">(</span><span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">],</span> <span class="n">excit_wfm</span><span class="p">[</span><span class="n">l_resp_ind</span><span class="p">:</span><span class="n">r_resp_ind</span><span class="p">],</span> <span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">posn</span><span class="p">,</span> <span class="n">l_resp_ind</span><span class="p">:</span><span class="n">r_resp_ind</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">col_val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">line_colors</span><span class="p">):</span>
                <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">excit_wfm</span><span class="p">[</span><span class="n">l_resp_ind</span><span class="p">:</span><span class="n">r_resp_ind</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[</span><span class="n">posn</span><span class="p">,</span> <span class="n">l_resp_ind</span><span class="p">:</span><span class="n">r_resp_ind</span><span class="p">],</span>
                                     <span class="n">color</span><span class="o">=</span><span class="n">col_val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">h5_pos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># print(&#39;Row &#39; + str(h5_pos[posn,1]) + &#39; Col &#39; + str(h5_pos[posn,0]))</span>
            <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Row &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">h5_pos</span><span class="p">[</span><span class="n">posn</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; Col &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">h5_pos</span><span class="p">[</span><span class="n">posn</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">subtitles</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">posn</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">count</span> <span class="o">%</span> <span class="n">sq_num_plots</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">sq_num_plots</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sq_num_plots</span><span class="p">:</span>
            <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
        <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">axes_lin</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">dataset_names</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span></div>


<span class="c1">###############################################################################</span>


<div class="viewcode-block" id="plot_complex_map_stack"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plot_complex_map_stack">[docs]</a><span class="k">def</span> <span class="nf">plot_complex_map_stack</span><span class="p">(</span><span class="n">map_stack</span><span class="p">,</span> <span class="n">num_comps</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Eigenvectors&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;UDVS Step&#39;</span><span class="p">,</span> <span class="n">stdevs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                           <span class="n">cmap</span><span class="o">=</span><span class="n">default_cmap</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the provided spectrograms from SVD V vector</span>

<span class="sd">    Parameters</span>
<span class="sd">    -------------</span>
<span class="sd">    map_stack : 3D numpy complex matrices</span>
<span class="sd">        Eigenvectors rearranged as - [row, col, component]</span>
<span class="sd">    num_comps : int</span>
<span class="sd">        Number of components to plot</span>
<span class="sd">    title : String</span>
<span class="sd">        Title to plot above everything else</span>
<span class="sd">    xlabel : String</span>
<span class="sd">        Label for x axis</span>
<span class="sd">    stdevs : int</span>
<span class="sd">        Number of standard deviations to consider for plotting</span>
<span class="sd">    cmap : String, or matplotlib.colors.LinearSegmentedColormap object (Optional)</span>
<span class="sd">        Requested color map</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    fig, axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap_object</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>

    <span class="n">fig201</span><span class="p">,</span> <span class="n">axes201</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_comps</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">num_comps</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">fig201</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">fig201</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_comps</span><span class="p">):</span>
        <span class="n">cur_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">map_stack</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes201</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">axes201</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="n">num_comps</span><span class="p">]]</span>
        <span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">]</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Phase&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">func</span><span class="p">,</span> <span class="n">lab</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">funcs</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
            <span class="n">amp_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">cur_map</span><span class="p">))</span>
            <span class="n">amp_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">cur_map</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">cur_map</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                      <span class="n">vmin</span><span class="o">=</span><span class="n">amp_mean</span> <span class="o">-</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">amp_std</span><span class="p">,</span>
                      <span class="n">vmax</span><span class="o">=</span><span class="n">amp_mean</span> <span class="o">+</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">amp_std</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Eigenvector: </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">lab</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig201</span><span class="p">,</span> <span class="n">axes201</span></div>


<span class="c1">###############################################################################</span>

<div class="viewcode-block" id="plot_complex_loop_stack"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plot_complex_loop_stack">[docs]</a><span class="k">def</span> <span class="nf">plot_complex_loop_stack</span><span class="p">(</span><span class="n">loop_stack</span><span class="p">,</span> <span class="n">x_axis</span><span class="p">,</span> <span class="n">heading</span><span class="o">=</span><span class="s1">&#39;BE Loops&#39;</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="s1">&#39;Eigenvector&#39;</span><span class="p">,</span> <span class="n">num_comps</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the provided spectrograms from SVD V vector</span>

<span class="sd">    Parameters</span>
<span class="sd">    -------------</span>
<span class="sd">    loop_stack : 3D numpy complex matrices</span>
<span class="sd">        Loops rearranged as - [component, points]</span>
<span class="sd">    x_axis : 1D real numpy array</span>
<span class="sd">        The vector to plot against</span>
<span class="sd">    heading : str</span>
<span class="sd">        Title to plot above everything else</span>
<span class="sd">    subtitle : str</span>
<span class="sd">        Subtile to of Figure</span>
<span class="sd">    num_comps : int</span>
<span class="sd">        Number of components to plot</span>
<span class="sd">    x_label : str</span>
<span class="sd">        Label for x axis</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    fig, axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Phase&#39;</span><span class="p">]</span>

    <span class="n">fig201</span><span class="p">,</span> <span class="n">axes201</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">funcs</span><span class="p">),</span> <span class="n">num_comps</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">num_comps</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">funcs</span><span class="p">)))</span>
    <span class="n">fig201</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">fig201</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">heading</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_comps</span><span class="p">):</span>
        <span class="n">cur_map</span> <span class="o">=</span> <span class="n">loop_stack</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes201</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">axes201</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="n">num_comps</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">func</span><span class="p">,</span> <span class="n">lab</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">funcs</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">cur_map</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">subtitle</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">lab</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>
    <span class="n">fig201</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">fig201</span><span class="p">,</span> <span class="n">axes201</span></div>


<span class="c1">###############################################################################</span>


<div class="viewcode-block" id="plotScree"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plotScree">[docs]</a><span class="k">def</span> <span class="nf">plotScree</span><span class="p">(</span><span class="n">scree</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Scree&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the scree or scree</span>

<span class="sd">    Parameters</span>
<span class="sd">    -------------</span>
<span class="sd">    scree : 1D real numpy array</span>
<span class="sd">        The scree vector from SVD</span>
<span class="sd">    title : str</span>
<span class="sd">        Figure title.  Default Scree</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    fig, axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig203</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">axes203</span> <span class="o">=</span> <span class="n">fig203</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">])</span>  <span class="c1"># left, bottom, width, height (range 0 to 1)</span>
    <span class="n">axes203</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scree</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">scree</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
    <span class="n">axes203</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Principal Component&#39;</span><span class="p">)</span>
    <span class="n">axes203</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Variance&#39;</span><span class="p">)</span>
    <span class="n">axes203</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">axes203</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">scree</span><span class="p">))</span>
    <span class="n">axes203</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">scree</span><span class="p">),</span> <span class="n">top</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">scree</span><span class="p">))</span>
    <span class="n">fig203</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="s2">&quot;Scree&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig203</span><span class="p">,</span> <span class="n">axes203</span></div>


<span class="c1"># ###############################################################################</span>


<div class="viewcode-block" id="plot_map_stack"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plot_map_stack">[docs]</a><span class="k">def</span> <span class="nf">plot_map_stack</span><span class="p">(</span><span class="n">map_stack</span><span class="p">,</span> <span class="n">num_comps</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">stdevs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color_bar_mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">evenly_spaced</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reverse_dims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Component&#39;</span><span class="p">,</span> <span class="n">heading</span><span class="o">=</span><span class="s1">&#39;Map Stack&#39;</span><span class="p">,</span> <span class="n">colorbar_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">fig_mult</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">pad_mult</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">),</span>
                   <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the provided stack of maps</span>

<span class="sd">    Parameters</span>
<span class="sd">    -------------</span>
<span class="sd">    map_stack : 3D real numpy array</span>
<span class="sd">        structured as [component, rows, cols]</span>
<span class="sd">    num_comps : unsigned int</span>
<span class="sd">        Number of components to plot</span>
<span class="sd">    stdevs : int</span>
<span class="sd">        Number of standard deviations to consider for plotting</span>
<span class="sd">    color_bar_mode : String, Optional</span>
<span class="sd">        Options are None, single or each. Default None</span>
<span class="sd">    evenly_spaced : bool</span>
<span class="sd">        Default False</span>
<span class="sd">    reverse_dims : Boolean (Optional)</span>
<span class="sd">        Set this to False to accept data structured as [component, rows, cols]</span>
<span class="sd">    title : String or list of strings</span>
<span class="sd">        The titles for each of the plots.</span>
<span class="sd">        If a single string is provided, the plot titles become [&#39;title 01&#39;, title 02&#39;, ...].</span>
<span class="sd">        if a list of strings (equal to the number of components) are provided, these are used instead.</span>
<span class="sd">    heading : String</span>
<span class="sd">        ###Insert description here### Default &#39;Map Stack&#39;</span>
<span class="sd">    colorbar_label : String</span>
<span class="sd">        label for colorbar. Default is an empty string.</span>
<span class="sd">    fig_mult : length 2 array_like of uints</span>
<span class="sd">        Size multipliers for the figure.  Figure size is calculated as (num_rows*`fig_mult[0]`, num_cols*`fig_mult[1]`).</span>
<span class="sd">        Default (4, 4)</span>
<span class="sd">    pad_mult : length 2 array_like of floats</span>
<span class="sd">        Multipliers for the axis padding between plots in the stack.  Padding is calculated as</span>
<span class="sd">        (pad_mult[0]*fig_mult[1], pad_mult[1]*fig_mult[0]) for the width and height padding respectively.</span>
<span class="sd">        Default (0.1, 0.07)</span>
<span class="sd">    kwargs : dictionary</span>
<span class="sd">        Keyword arguments to be passed to either matplotlib.pyplot.figure, mpl_toolkits.axes_grid1.ImageGrid, or</span>
<span class="sd">        pycroscopy.vis.plot_utils.plot_map.  See specific function documentation for the relavent options.</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    fig, axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">reverse_dims</span><span class="p">:</span>
        <span class="n">map_stack</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">map_stack</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">num_comps</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">num_comps</span><span class="p">)</span>
    <span class="n">num_comps</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">num_comps</span><span class="p">,</span> <span class="n">map_stack</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">evenly_spaced</span><span class="p">:</span>
        <span class="n">chosen_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">map_stack</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_comps</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">chosen_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_comps</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">num_comps</span><span class="p">:</span>
            <span class="c1"># remove additional titles</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="p">[:</span><span class="n">num_comps</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_comps</span><span class="p">:</span>
            <span class="c1"># add titles</span>
            <span class="n">title</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Component&#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">),</span> <span class="n">num_comps</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Component&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="p">[</span><span class="n">title</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">chosen_pos</span><span class="p">]</span>

    <span class="n">fig_h</span><span class="p">,</span> <span class="n">fig_w</span> <span class="o">=</span> <span class="n">fig_mult</span>
    <span class="n">p_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num_comps</span><span class="p">)))</span>
    <span class="n">p_cols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_comps</span> <span class="o">/</span> <span class="n">p_rows</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_rows</span> <span class="o">*</span> <span class="n">p_cols</span> <span class="o">&lt;</span> <span class="n">num_comps</span><span class="p">:</span>
        <span class="n">p_cols</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">pad_w</span><span class="p">,</span> <span class="n">pad_h</span> <span class="o">=</span> <span class="n">pad_mult</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Set defaults for kwargs to the figure creation and extract any non-default values from current kwargs</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">figkwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">inspec_func</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getfullargspec</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">inspec_func</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">inspec_func</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">figkwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)})</span>

    <span class="n">fig202</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">p_cols</span> <span class="o">*</span> <span class="n">fig_w</span><span class="p">,</span> <span class="n">p_rows</span> <span class="o">*</span> <span class="n">fig_h</span><span class="p">),</span> <span class="o">**</span><span class="n">figkwargs</span><span class="p">)</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Set defaults for kwargs to the ImageGrid and extract any non-default values from current kwargs</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">igkwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cbar_pad&#39;</span><span class="p">:</span> <span class="s1">&#39;1%&#39;</span><span class="p">,</span>
                <span class="s1">&#39;cbar_size&#39;</span><span class="p">:</span> <span class="s1">&#39;5%&#39;</span><span class="p">,</span>
                <span class="s1">&#39;cbar_location&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
                <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;row&#39;</span><span class="p">,</span>
                <span class="s1">&#39;add_all&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;share_all&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;aspect&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;label_mode&#39;</span><span class="p">:</span> <span class="s1">&#39;L&#39;</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">igkwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">igkwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)})</span>

    <span class="n">axes202</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig202</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="n">p_rows</span><span class="p">,</span> <span class="n">p_cols</span><span class="p">),</span>
                        <span class="n">cbar_mode</span><span class="o">=</span><span class="n">color_bar_mode</span><span class="p">,</span>
                        <span class="n">axes_pad</span><span class="o">=</span><span class="p">(</span><span class="n">pad_w</span> <span class="o">*</span> <span class="n">fig_w</span><span class="p">,</span> <span class="n">pad_h</span> <span class="o">*</span> <span class="n">fig_h</span><span class="p">),</span>
                        <span class="o">**</span><span class="n">igkwargs</span><span class="p">)</span>
    <span class="n">fig202</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">heading</span><span class="p">)</span>
    <span class="n">fig202</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">heading</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">p_rows</span><span class="o">+</span> <span class="n">p_cols</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">subtitle</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">chosen_pos</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">chosen_pos</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">plot_map</span><span class="p">(</span><span class="n">axes202</span><span class="p">[</span><span class="n">count</span><span class="p">],</span>
                      <span class="n">map_stack</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
                      <span class="n">stdevs</span><span class="o">=</span><span class="n">stdevs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">axes202</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">subtitle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">color_bar_mode</span> <span class="ow">is</span> <span class="s1">&#39;each&#39;</span><span class="p">:</span>
            <span class="n">cb</span> <span class="o">=</span> <span class="n">axes202</span><span class="o">.</span><span class="n">cbar_axes</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_label_text</span><span class="p">(</span><span class="n">colorbar_label</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">color_bar_mode</span> <span class="ow">is</span> <span class="s1">&#39;single&#39;</span><span class="p">:</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">axes202</span><span class="o">.</span><span class="n">cbar_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_label_text</span><span class="p">(</span><span class="n">colorbar_label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig202</span><span class="p">,</span> <span class="n">axes202</span></div>


<div class="viewcode-block" id="plot_cluster_h5_group"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plot_cluster_h5_group">[docs]</a><span class="k">def</span> <span class="nf">plot_cluster_h5_group</span><span class="p">(</span><span class="n">h5_group</span><span class="p">,</span> <span class="n">centroids_together</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">default_cmap</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the cluster labels and mean response for each cluster</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h5_group : h5py.Datagroup object</span>
<span class="sd">        H5 group containing the labels and mean response</span>
<span class="sd">    centroids_together : Boolean, optional - default = True</span>
<span class="sd">        Whether or nor to plot all centroids together on the same plot</span>
<span class="sd">    cmap : plt.cm object or str, optional</span>
<span class="sd">        Colormap to use for the labels map and the centroid.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : Figure</span>
<span class="sd">        Figure containing the plots</span>
<span class="sd">    axes : 1D array_like of axes objects</span>
<span class="sd">        Axes of the individual plots within `fig`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">h5_labels</span> <span class="o">=</span> <span class="n">h5_group</span><span class="p">[</span><span class="s1">&#39;Labels&#39;</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">h5_mean_resp</span> <span class="o">=</span> <span class="n">h5_group</span><span class="p">[</span><span class="s1">&#39;Mean_Response&#39;</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="c1"># old PySPM format:</span>
        <span class="n">h5_mean_resp</span> <span class="o">=</span> <span class="n">h5_group</span><span class="p">[</span><span class="s1">&#39;Centroids&#39;</span><span class="p">]</span>

    <span class="c1"># Reshape the mean response to N dimensions</span>
    <span class="n">mean_response</span><span class="p">,</span> <span class="n">success</span> <span class="o">=</span> <span class="n">reshape_to_Ndims</span><span class="p">(</span><span class="n">h5_mean_resp</span><span class="p">)</span>

    <span class="c1"># unfortunately, we cannot use the above function for the labels</span>
    <span class="c1"># However, we will assume that the position values are linked to the labels:</span>
    <span class="n">h5_pos_vals</span> <span class="o">=</span> <span class="n">h5_labels</span><span class="o">.</span><span class="n">file</span><span class="p">[</span><span class="n">h5_labels</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;Position_Values&#39;</span><span class="p">]]</span>
    <span class="n">h5_pos_inds</span> <span class="o">=</span> <span class="n">h5_labels</span><span class="o">.</span><span class="n">file</span><span class="p">[</span><span class="n">h5_labels</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;Position_Indices&#39;</span><span class="p">]]</span>

    <span class="c1"># Reshape the labels correctly:</span>
    <span class="n">pos_dims</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">h5_pos_inds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">pos_dims</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">h5_pos_inds</span><span class="p">[:,</span> <span class="n">col</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="n">pos_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">h5_pos_vals</span><span class="p">[:</span><span class="n">pos_dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span> <span class="n">h5_pos_vals</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">pos_dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">1</span><span class="p">]]</span>
    <span class="c1"># prepare the axes ticks for the map</span>

    <span class="n">pos_dims</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>  <span class="c1"># go from slowest to fastest</span>
    <span class="n">pos_dims</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">pos_dims</span><span class="p">)</span>
    <span class="n">label_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">h5_labels</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">pos_dims</span><span class="p">)</span>

    <span class="c1"># Figure out the correct units and labels for mean response:</span>
    <span class="n">h5_spec_vals</span> <span class="o">=</span> <span class="n">h5_mean_resp</span><span class="o">.</span><span class="n">file</span><span class="p">[</span><span class="n">h5_mean_resp</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;Spectroscopic_Values&#39;</span><span class="p">]]</span>
    <span class="n">x_spec_label</span> <span class="o">=</span> <span class="n">get_formatted_labels</span><span class="p">(</span><span class="n">h5_spec_vals</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Figure out the correct axes labels for label map:</span>
    <span class="n">pos_labels</span> <span class="o">=</span> <span class="n">get_formatted_labels</span><span class="p">(</span><span class="n">h5_pos_vals</span><span class="p">)</span>

    <span class="n">y_spec_label</span> <span class="o">=</span> <span class="n">get_data_descriptor</span><span class="p">(</span><span class="n">h5_mean_resp</span><span class="p">)</span>
    <span class="c1"># TODO: cleaner x and y axes labels instead of 0.0000125 etc.</span>

    <span class="k">if</span> <span class="n">centroids_together</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">plot_cluster_results_together</span><span class="p">(</span><span class="n">label_mat</span><span class="p">,</span> <span class="n">mean_response</span><span class="p">,</span> <span class="n">spec_val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">h5_spec_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                             <span class="n">spec_label</span><span class="o">=</span><span class="n">x_spec_label</span><span class="p">,</span> <span class="n">resp_label</span><span class="o">=</span><span class="n">y_spec_label</span><span class="p">,</span>
                                             <span class="n">pos_labels</span><span class="o">=</span><span class="n">pos_labels</span><span class="p">,</span> <span class="n">pos_ticks</span><span class="o">=</span><span class="n">pos_ticks</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">plot_cluster_results_separate</span><span class="p">(</span><span class="n">label_mat</span><span class="p">,</span> <span class="n">mean_response</span><span class="p">,</span> <span class="n">max_centroids</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="n">x_spec_label</span><span class="p">,</span>
                                             <span class="n">spec_val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">h5_spec_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">y_label</span><span class="o">=</span><span class="n">y_spec_label</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span></div>


<span class="c1">###############################################################################</span>


<div class="viewcode-block" id="plot_cluster_results_together"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plot_cluster_results_together">[docs]</a><span class="k">def</span> <span class="nf">plot_cluster_results_together</span><span class="p">(</span><span class="n">label_mat</span><span class="p">,</span> <span class="n">mean_response</span><span class="p">,</span> <span class="n">spec_val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">default_cmap</span><span class="p">,</span>
                                  <span class="n">spec_label</span><span class="o">=</span><span class="s1">&#39;Spectroscopic Value&#39;</span><span class="p">,</span> <span class="n">resp_label</span><span class="o">=</span><span class="s1">&#39;Response&#39;</span><span class="p">,</span>
                                  <span class="n">pos_labels</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span> <span class="n">pos_ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the cluster labels and mean response for each cluster in separate plots</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    label_mat : 2D ndarray or h5py.Dataset of ints</span>
<span class="sd">        Spatial map of cluster labels structured as [rows, cols]</span>
<span class="sd">    mean_response : 2D array or h5py.Dataset</span>
<span class="sd">        Mean value of each cluster over all samples </span>
<span class="sd">        arranged as [cluster number, features]</span>
<span class="sd">    spec_val :  1D array or h5py.Dataset of floats, optional</span>
<span class="sd">        X axis to plot the centroids against</span>
<span class="sd">        If no value is specified, the data is plotted against the index</span>
<span class="sd">    cmap : plt.cm object or str, optional</span>
<span class="sd">        Colormap to use for the labels map and the centroid.</span>
<span class="sd">        Advised to pick a map where the centroid plots show clearly.</span>
<span class="sd">        Default = matplotlib.pyplot.cm.jet</span>
<span class="sd">    spec_label : str, optional</span>
<span class="sd">        Label to use for X axis on cluster centroid plot</span>
<span class="sd">        Default = &#39;Spectroscopic Value&#39;</span>
<span class="sd">    resp_label : str, optional</span>
<span class="sd">        Label to use for Y axis on cluster centroid plot</span>
<span class="sd">         Default = &#39;Response&#39;</span>
<span class="sd">    pos_labels : array_like of str, optional</span>
<span class="sd">        Labels to use for the X and Y axes on the Label map</span>
<span class="sd">        Default = (&#39;X&#39;, &#39;Y&#39;)</span>
<span class="sd">    pos_ticks : array_like of int</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : Figure</span>
<span class="sd">        Figure containing the plots</span>
<span class="sd">    axes : 1D array_like of axes objects</span>
<span class="sd">        Axes of the individual plots within `fig`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap_object</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__plot_centroids</span><span class="p">(</span><span class="n">centroids</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">spec_val</span><span class="p">,</span> <span class="n">spec_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">plot_line_family</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">spec_val</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">label_prefix</span><span class="o">=</span><span class="s1">&#39;Cluster&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
        <span class="c1"># ax.legend(loc=&#39;best&#39;)</span>
        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">spec_label</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">spec_val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">spec_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mean_response</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">mean_response</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">complex64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">]:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">ax_map</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_amp</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">ax_phase</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax_map</span><span class="p">,</span> <span class="n">ax_amp</span><span class="p">,</span> <span class="n">ax_phase</span><span class="p">]</span>

        <span class="n">__plot_centroids</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">mean_response</span><span class="p">),</span> <span class="n">ax_amp</span><span class="p">,</span> <span class="n">spec_val</span><span class="p">,</span> <span class="n">spec_label</span><span class="p">,</span>
                         <span class="n">resp_label</span> <span class="o">+</span> <span class="s1">&#39; - Amplitude&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="s1">&#39;Mean Response&#39;</span><span class="p">)</span>
        <span class="n">__plot_centroids</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">mean_response</span><span class="p">),</span> <span class="n">ax_phase</span><span class="p">,</span> <span class="n">spec_val</span><span class="p">,</span> <span class="n">spec_label</span><span class="p">,</span>
                         <span class="n">resp_label</span> <span class="o">+</span> <span class="s1">&#39; - Phase&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="p">)</span>
        <span class="n">plot_handles</span><span class="p">,</span> <span class="n">plot_labels</span> <span class="o">=</span> <span class="n">ax_amp</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">ax_map</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">ax_resp</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax_map</span><span class="p">,</span> <span class="n">ax_resp</span><span class="p">]</span>
        <span class="n">__plot_centroids</span><span class="p">(</span><span class="n">mean_response</span><span class="p">,</span> <span class="n">ax_resp</span><span class="p">,</span> <span class="n">spec_val</span><span class="p">,</span> <span class="n">spec_label</span><span class="p">,</span>
                         <span class="n">resp_label</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="s1">&#39;Mean Response&#39;</span><span class="p">)</span>
        <span class="n">plot_handles</span><span class="p">,</span> <span class="n">plot_labels</span> <span class="o">=</span> <span class="n">ax_resp</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>

    <span class="n">fleg</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figlegend</span><span class="p">(</span><span class="n">plot_handles</span><span class="p">,</span> <span class="n">plot_labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center right&#39;</span><span class="p">,</span>
                         <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">num_clusters</span> <span class="o">=</span> <span class="n">mean_response</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label_mat</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reshape label_mat based on linked positions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">label_mat</span><span class="o">.</span><span class="n">file</span><span class="p">[</span><span class="n">label_mat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;Position_Indices&#39;</span><span class="p">]]</span>
        <span class="n">nx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]))</span>
        <span class="n">ny</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]))</span>
        <span class="n">label_mat</span> <span class="o">=</span> <span class="n">label_mat</span><span class="p">[()]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>

    <span class="c1"># im = ax_map.imshow(label_mat, interpolation=&#39;none&#39;)</span>
    <span class="n">ax_map</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">pos_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax_map</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">pos_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">pos_ticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">label_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
        <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">label_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
        <span class="n">ax_map</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x_ticks</span><span class="p">)</span>
        <span class="n">ax_map</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_ticks</span><span class="p">)</span>
        <span class="n">ax_map</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">pos_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">x_ticks</span><span class="p">])</span>
        <span class="n">ax_map</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">pos_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">y_ticks</span><span class="p">])</span>

    <span class="sd">&quot;&quot;&quot;divider = make_axes_locatable(ax_map)</span>
<span class="sd">    cax = divider.append_axes(&quot;right&quot;, size=&quot;5%&quot;, pad=0.05)  # space for colorbar</span>
<span class="sd">    fig.colorbar(im, cax=cax, ticks=np.arange(num_clusters),</span>
<span class="sd">                 cmap=discrete_cmap(num_clusters, base_cmap=plt.cm.viridis))</span>
<span class="sd">    ax_map.axis(&#39;tight&#39;)&quot;&quot;&quot;</span>
    <span class="n">pcol0</span> <span class="o">=</span> <span class="n">ax_map</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">label_mat</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">discrete_cmap</span><span class="p">(</span><span class="n">num_clusters</span><span class="p">,</span> <span class="n">base_cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pcol0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_map</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_clusters</span><span class="p">))</span>
    <span class="n">ax_map</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">ax_map</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">ax_map</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cluster Label Map&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="s1">&#39;Cluster results&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span></div>


<span class="c1">###############################################################################</span>


<div class="viewcode-block" id="plot_cluster_results_separate"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plot_cluster_results_separate">[docs]</a><span class="k">def</span> <span class="nf">plot_cluster_results_separate</span><span class="p">(</span><span class="n">label_mat</span><span class="p">,</span> <span class="n">cluster_centroids</span><span class="p">,</span> <span class="n">max_centroids</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">default_cmap</span><span class="p">,</span>
                                  <span class="n">spec_val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Excitation (a.u.)&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Response (a.u.)&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the provided labels mat and centroids from clustering</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    label_mat : 2D int numpy array</span>
<span class="sd">                structured as [rows, cols]</span>
<span class="sd">    cluster_centroids: 2D real numpy array</span>
<span class="sd">                       structured as [cluster,features]</span>
<span class="sd">    max_centroids : unsigned int</span>
<span class="sd">                    Number of centroids to plot</span>
<span class="sd">    cmap : plt.cm object or str, optional</span>
<span class="sd">        Colormap to use for the labels map and the centroids</span>
<span class="sd">    spec_val :  array-like</span>
<span class="sd">        X axis to plot the centroids against</span>
<span class="sd">        If no value is specified, the data is plotted against the index</span>
<span class="sd">    x_label : String / unicode</span>
<span class="sd">              X label for centroid plots</span>
<span class="sd">    y_label : String / unicode</span>
<span class="sd">              Y label for centroid plots</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap_object</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">max_centroids</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>

        <span class="n">fig501</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">fax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">fax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">fax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">fax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">fax5</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">fig501</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">axes_handles</span> <span class="o">=</span> <span class="p">[</span><span class="n">fax1</span><span class="p">,</span> <span class="n">fax2</span><span class="p">,</span> <span class="n">fax3</span><span class="p">,</span> <span class="n">fax4</span><span class="p">,</span> <span class="n">fax5</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig501</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="c1"># make subplot for cluster map</span>
        <span class="n">fax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># For cluster map</span>
        <span class="n">fax1</span><span class="o">.</span><span class="n">set_xmargin</span><span class="p">(</span><span class="mf">0.50</span><span class="p">)</span>
        <span class="c1"># make subplot for cluster centers</span>
        <span class="n">fax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">fax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">fax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">fax5</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">fax6</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">fax7</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">fax8</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">fax9</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">fax10</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">fig501</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">axes_handles</span> <span class="o">=</span> <span class="p">[</span><span class="n">fax1</span><span class="p">,</span> <span class="n">fax2</span><span class="p">,</span> <span class="n">fax3</span><span class="p">,</span> <span class="n">fax4</span><span class="p">,</span> <span class="n">fax5</span><span class="p">,</span> <span class="n">fax6</span><span class="p">,</span> <span class="n">fax7</span><span class="p">,</span> <span class="n">fax8</span><span class="p">,</span> <span class="n">fax9</span><span class="p">,</span> <span class="n">fax10</span><span class="p">]</span>

    <span class="c1"># First plot the labels map:</span>
    <span class="n">pcol0</span> <span class="o">=</span> <span class="n">fax1</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">label_mat</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">discrete_cmap</span><span class="p">(</span><span class="n">cluster_centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">base_cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">))</span>
    <span class="n">fig501</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pcol0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">fax1</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cluster_centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">fax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">fax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">fax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cluster Label Map&#39;</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;im = fax1.imshow(label_mat, interpolation=&#39;none&#39;)</span>
<span class="sd">    divider = make_axes_locatable(fax1)</span>
<span class="sd">    cax = divider.append_axes(&quot;right&quot;, size=&quot;5%&quot;, pad=0.05)  # space for colorbar</span>
<span class="sd">    plt.colorbar(im, cax=cax)&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">spec_val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cluster_centroids</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">spec_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cluster_centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Plot results</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes_handles</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span> <span class="n">max_centroids</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">max_centroids</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">cluster_centroids</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec_val</span><span class="p">,</span> <span class="n">cluster_centroids</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:],</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">index</span> <span class="o">/</span> <span class="p">(</span><span class="n">cluster_centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cluster_centroids</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">plot_map</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cluster_centroids</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Centroid: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">index</span><span class="p">)</span>

    <span class="n">fig501</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.60</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.60</span><span class="p">)</span>
    <span class="n">fig501</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">fig501</span></div>


<span class="c1">###############################################################################</span>

<div class="viewcode-block" id="plot_cluster_dendrogram"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plot_cluster_dendrogram">[docs]</a><span class="k">def</span> <span class="nf">plot_cluster_dendrogram</span><span class="p">(</span><span class="n">label_mat</span><span class="p">,</span> <span class="n">e_vals</span><span class="p">,</span> <span class="n">num_comp</span><span class="p">,</span> <span class="n">num_cluster</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;Full&#39;</span><span class="p">,</span> <span class="n">last</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">sort_type</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">sort_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates and plots the dendrograms for the given label_mat and</span>
<span class="sd">    eigenvalues</span>

<span class="sd">    Parameters</span>
<span class="sd">    -------------</span>
<span class="sd">    label_mat : 2D real numpy array</span>
<span class="sd">        structured as [rows, cols], from KMeans clustering</span>
<span class="sd">    e_vals: 3D real numpy array of eigenvalues</span>
<span class="sd">        structured as [component, rows, cols]</span>
<span class="sd">    num_comp : int</span>
<span class="sd">        Number of components used to make eigenvalues</span>
<span class="sd">    num_cluster : int</span>
<span class="sd">        Number of cluster used to make the label_mat</span>
<span class="sd">    mode: str, optional</span>
<span class="sd">        How should the dendrograms be created.</span>
<span class="sd">        &quot;Full&quot; -- use all clusters when creating the dendrograms</span>
<span class="sd">        &quot;Truncated&quot; -- stop showing clusters after &#39;last&#39;</span>
<span class="sd">    last: int, optional - should be provided when using &quot;Truncated&quot;</span>
<span class="sd">        How many merged clusters should be shown when using</span>
<span class="sd">        &quot;Truncated&quot; mode</span>
<span class="sd">    sort_type: {&#39;count&#39;, &#39;distance&#39;}, optional</span>
<span class="sd">        What type of sorting should be used when plotting the</span>
<span class="sd">        dendrograms.  Options are:</span>
<span class="sd">        count - Uses the count_sort from scipy.cluster.hierachy.dendrogram</span>
<span class="sd">        distance - Uses the distance_sort from scipy.cluster.hierachy.dendrogram</span>
<span class="sd">    sort_mode: {False, True, &#39;ascending&#39;, &#39;descending&#39;}, optional</span>
<span class="sd">        For the chosen sort_type, which mode should be used.</span>
<span class="sd">        False - Does no sorting</span>
<span class="sd">        &#39;ascending&#39; or True - The child with the minimum of the chosen sort</span>
<span class="sd">        parameter is plotted first</span>
<span class="sd">        &#39;descending&#39; - The child with the maximum of the chosen sort parameter is</span>
<span class="sd">        plotted first</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    fig : matplotlib.pyplot Figure object</span>
<span class="sd">        Figure containing the dendrogram</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;Truncated&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">last</span><span class="p">:</span>
        <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Warning: Truncated dendrograms requested, but no last cluster given.  Reverting to full dendrograms.&#39;</span><span class="p">)</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;Full&#39;</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;Full&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Creating full dendrogram from clusters&#39;</span><span class="p">)</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;Truncated&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Creating truncated dendrogram from clusters.  Will stop at </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">last</span><span class="p">))</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lastp&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Error: Unknown mode requested for plotting dendrograms. mode=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>

    <span class="n">c_sort</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">d_sort</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">sort_type</span> <span class="o">==</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span>
        <span class="n">c_sort</span> <span class="o">=</span> <span class="n">sort_mode</span>
        <span class="k">if</span> <span class="n">c_sort</span> <span class="o">==</span> <span class="s1">&#39;descending&#39;</span><span class="p">:</span>
            <span class="n">c_sort</span> <span class="o">=</span> <span class="s1">&#39;descendent&#39;</span>
    <span class="k">elif</span> <span class="n">sort_type</span> <span class="o">==</span> <span class="s1">&#39;distance&#39;</span><span class="p">:</span>
        <span class="n">d_sort</span> <span class="o">=</span> <span class="n">sort_mode</span>

    <span class="n">centroid_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">num_cluster</span><span class="p">,</span> <span class="n">num_comp</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_cluster</span><span class="p">):</span>
        <span class="p">[</span><span class="n">i_x</span><span class="p">,</span> <span class="n">i_y</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">label_mat</span> <span class="o">==</span> <span class="n">k1</span><span class="p">)</span>
        <span class="n">u_stack</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">i_x</span><span class="p">),</span> <span class="n">num_comp</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i_x</span><span class="p">)):</span>
            <span class="n">u_stack</span><span class="p">[</span><span class="n">k2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">e_vals</span><span class="p">[</span><span class="n">i_x</span><span class="p">[</span><span class="n">k2</span><span class="p">],</span> <span class="n">i_y</span><span class="p">[</span><span class="n">k2</span><span class="p">],</span> <span class="p">:</span><span class="n">num_comp</span><span class="p">])</span>

        <span class="n">centroid_mat</span><span class="p">[</span><span class="n">k1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">u_stack</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Get the distrance between cluster means</span>
    <span class="n">distance_mat</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">pdist</span><span class="p">(</span><span class="n">centroid_mat</span><span class="p">)</span>

    <span class="c1"># get hierachical pairings of clusters</span>
    <span class="n">linkage_pairing</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">hierarchy</span><span class="o">.</span><span class="n">linkage</span><span class="p">(</span><span class="n">distance_mat</span><span class="p">,</span> <span class="s1">&#39;weighted&#39;</span><span class="p">)</span>
    <span class="n">linkage_pairing</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">linkage_pairing</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">linkage_pairing</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">scipy</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">hierarchy</span><span class="o">.</span><span class="n">dendrogram</span><span class="p">(</span><span class="n">linkage_pairing</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">last</span><span class="p">,</span> <span class="n">truncate_mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
                                       <span class="n">count_sort</span><span class="o">=</span><span class="n">c_sort</span><span class="p">,</span> <span class="n">distance_sort</span><span class="o">=</span><span class="n">d_sort</span><span class="p">,</span>
                                       <span class="n">leaf_rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Dendrogram&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Index or (cluster size)&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Distance&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="plot_1d_spectrum"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plot_1d_spectrum">[docs]</a><span class="k">def</span> <span class="nf">plot_1d_spectrum</span><span class="p">(</span><span class="n">data_vec</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">figure_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the Step averaged BE response</span>

<span class="sd">    Parameters</span>
<span class="sd">    ------------</span>
<span class="sd">    data_vec : 1D numpy array</span>
<span class="sd">        Response of one BE pulse</span>
<span class="sd">    freq : 1D numpy array</span>
<span class="sd">        BE frequency that serves as the X axis of the plot</span>
<span class="sd">    title : String</span>
<span class="sd">        Plot group name</span>
<span class="sd">    figure_path : String / Unicode</span>
<span class="sd">        Absolute path of the file to write the figure to</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    fig : Matplotlib.pyplot figure</span>
<span class="sd">        Figure handle</span>
<span class="sd">    ax : Matplotlib.pyplot axis</span>
<span class="sd">        Axis handle</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_vec</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">freq</span><span class="p">):</span>
        <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;plot_1d_spectrum: Incompatible data sizes!!!!&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1D:&#39;</span><span class="p">,</span> <span class="n">data_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">freq</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">freq</span> <span class="o">*=</span> <span class="mf">1E-3</span>  <span class="c1"># to kHz</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data_vec</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1E+3</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Amplitude (mV)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">data_vec</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Phase (deg)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (kHz)&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;: mean UDVS, mean spatial response&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">figure_path</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figure_path</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
    <span class="k">return</span></div>


<span class="c1">###############################################################################</span>

<div class="viewcode-block" id="plot_2d_spectrogram"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plot_2d_spectrogram">[docs]</a><span class="k">def</span> <span class="nf">plot_2d_spectrogram</span><span class="p">(</span><span class="n">mean_spectrogram</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">figure_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the position averaged spectrogram</span>

<span class="sd">    Parameters</span>
<span class="sd">    ------------</span>
<span class="sd">    mean_spectrogram : 2D numpy complex array</span>
<span class="sd">        Means spectrogram arranged as [frequency, UDVS step]</span>
<span class="sd">    freq : 1D numpy float array</span>
<span class="sd">        BE frequency that serves as the X axis of the plot</span>
<span class="sd">    title : String</span>
<span class="sd">        Plot group name</span>
<span class="sd">    figure_path : String / Unicode</span>
<span class="sd">        Absolute path of the file to write the figure to</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    fig : Matplotlib.pyplot figure</span>
<span class="sd">        Figure handle</span>
<span class="sd">    ax : Matplotlib.pyplot axis</span>
<span class="sd">        Axis handle</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mean_spectrogram</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">freq</span><span class="p">):</span>
        <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;plot_2d_spectrogram: Incompatible data sizes!!!!&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2D:&#39;</span><span class="p">,</span> <span class="n">mean_spectrogram</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">freq</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">freq</span> <span class="o">*=</span> <span class="mf">1E-3</span>  <span class="c1"># to kHz</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># print(mean_spectrogram.shape)</span>
    <span class="c1"># print(freq.shape)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">mean_spectrogram</span><span class="p">),</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
                 <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">freq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">freq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">mean_spectrogram</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="c1"># ax[0].set_xticks(freq)</span>
    <span class="c1"># ax[0].set_ylabel(&#39;UDVS Step&#39;)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">mean_spectrogram</span><span class="p">),</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
                 <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">freq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">freq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">mean_spectrogram</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Phase&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (kHz)&#39;</span><span class="p">)</span>
    <span class="c1"># ax[0].set_ylabel(&#39;UDVS Step&#39;)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">figure_path</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figure_path</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>


<span class="c1">###############################################################################</span>


<div class="viewcode-block" id="plot_histgrams"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plot_histgrams">[docs]</a><span class="k">def</span> <span class="nf">plot_histgrams</span><span class="p">(</span><span class="n">p_hist</span><span class="p">,</span> <span class="n">p_hbins</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">figure_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the position averaged spectrogram</span>

<span class="sd">    Parameters</span>
<span class="sd">    ------------</span>
<span class="sd">    p_hist : 2D numpy array</span>
<span class="sd">        histogram data arranged as [physical quantity, frequency bin]</span>
<span class="sd">    p_hbins : 1D numpy array</span>
<span class="sd">        BE frequency that serves as the X axis of the plot</span>
<span class="sd">    title : String</span>
<span class="sd">        Plot group name</span>
<span class="sd">    figure_path : String / Unicode</span>
<span class="sd">        Absolute path of the file to write the figure to</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------</span>
<span class="sd">    fig : Matplotlib.pyplot figure</span>
<span class="sd">        Figure handle</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">base_fig_size</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">h_fig</span> <span class="o">=</span> <span class="n">base_fig_size</span>
    <span class="n">w_fig</span> <span class="o">=</span> <span class="n">base_fig_size</span> <span class="o">*</span> <span class="mi">4</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">w_fig</span><span class="p">,</span> <span class="n">h_fig</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">iplot</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">p_Nx</span><span class="p">,</span> <span class="n">p_Ny</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">p_hbins</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">p_hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_hist</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">p_Ny</span><span class="p">,</span> <span class="n">p_Nx</span><span class="p">))</span>

    <span class="n">iplot</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">p_plot_title</span> <span class="o">=</span> <span class="s1">&#39;Spectral BEHistogram Amp (log10 of counts)&#39;</span>
    <span class="n">p_plot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">iplot</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">p_plot_title</span><span class="p">)</span>
    <span class="n">p_im</span> <span class="o">=</span> <span class="n">p_plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">p_hist</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
    <span class="n">p_plot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">p_im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="n">iplot</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">p_plot_title</span> <span class="o">=</span> <span class="s1">&#39;Spectral BEHistogram Phase (log10 of counts)&#39;</span>
    <span class="n">p_plot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">iplot</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">p_plot_title</span><span class="p">)</span>
    <span class="n">p_im</span> <span class="o">=</span> <span class="n">p_plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">p_hist</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
    <span class="n">p_plot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">p_im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="n">iplot</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">p_plot_title</span> <span class="o">=</span> <span class="s1">&#39;Spectral BEHistogram Real (log10 of counts)&#39;</span>
    <span class="n">p_plot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">iplot</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">p_plot_title</span><span class="p">)</span>
    <span class="n">p_im</span> <span class="o">=</span> <span class="n">p_plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">p_hist</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
    <span class="n">p_plot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">p_im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="n">iplot</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">p_plot_title</span> <span class="o">=</span> <span class="s1">&#39;Spectral BEHistogram Imag (log10 of counts)&#39;</span>
    <span class="n">p_plot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">iplot</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">p_plot_title</span><span class="p">)</span>
    <span class="n">p_im</span> <span class="o">=</span> <span class="n">p_plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">p_hist</span><span class="p">[</span><span class="mi">3</span><span class="p">])),</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
    <span class="n">p_plot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">p_im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">figure_path</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figure_path</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="plot_image_cleaning_results"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.plot_image_cleaning_results">[docs]</a><span class="k">def</span> <span class="nf">plot_image_cleaning_results</span><span class="p">(</span><span class="n">raw_image</span><span class="p">,</span> <span class="n">clean_image</span><span class="p">,</span> <span class="n">stdevs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">heading</span><span class="o">=</span><span class="s1">&#39;Image Cleaning Results&#39;</span><span class="p">,</span>
                                <span class="n">fig_mult</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">fig_args</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    raw_image</span>
<span class="sd">    clean_image</span>
<span class="sd">    stdevs</span>
<span class="sd">    fig_mult</span>
<span class="sd">    fig_args</span>
<span class="sd">    heading</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plot_args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cbar_pad&#39;</span><span class="p">:</span> <span class="s1">&#39;2.0%&#39;</span><span class="p">,</span> <span class="s1">&#39;cbar_size&#39;</span><span class="p">:</span> <span class="s1">&#39;4%&#39;</span><span class="p">,</span> <span class="s1">&#39;hor_axis_pad&#39;</span><span class="p">:</span> <span class="mf">0.115</span><span class="p">,</span> <span class="s1">&#39;vert_axis_pad&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                 <span class="s1">&#39;sup_title_size&#39;</span><span class="p">:</span> <span class="mi">26</span><span class="p">,</span> <span class="s1">&#39;sub_title_size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;show_x_y_ticks&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;show_tick_marks&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="s1">&#39;x_y_tick_font_size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;cbar_tick_font_size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">}</span>

    <span class="n">plot_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fig_args</span><span class="p">)</span>

    <span class="n">fig_h</span><span class="p">,</span> <span class="n">fig_w</span> <span class="o">=</span> <span class="n">fig_mult</span>
    <span class="n">p_rows</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">p_cols</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="n">fig_clean</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">p_cols</span> <span class="o">*</span> <span class="n">fig_w</span><span class="p">,</span> <span class="n">p_rows</span> <span class="o">*</span> <span class="n">fig_h</span><span class="p">))</span>
    <span class="n">axes_clean</span> <span class="o">=</span> <span class="n">ImageGrid</span><span class="p">(</span><span class="n">fig_clean</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="n">nrows_ncols</span><span class="o">=</span><span class="p">(</span><span class="n">p_rows</span><span class="p">,</span> <span class="n">p_cols</span><span class="p">),</span> <span class="n">cbar_mode</span><span class="o">=</span><span class="s1">&#39;each&#39;</span><span class="p">,</span>
                           <span class="n">cbar_pad</span><span class="o">=</span><span class="n">plot_args</span><span class="p">[</span><span class="s1">&#39;cbar_pad&#39;</span><span class="p">],</span> <span class="n">cbar_size</span><span class="o">=</span><span class="n">plot_args</span><span class="p">[</span><span class="s1">&#39;cbar_size&#39;</span><span class="p">],</span>
                           <span class="n">axes_pad</span><span class="o">=</span><span class="p">(</span><span class="n">plot_args</span><span class="p">[</span><span class="s1">&#39;hor_axis_pad&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">fig_w</span><span class="p">,</span> <span class="n">plot_args</span><span class="p">[</span><span class="s1">&#39;vert_axis_pad&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">fig_h</span><span class="p">))</span>
    <span class="n">fig_clean</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="n">heading</span><span class="p">)</span>
    <span class="n">fig_clean</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">heading</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">plot_args</span><span class="p">[</span><span class="s1">&#39;sup_title_size&#39;</span><span class="p">])</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculate the removed noise and the FFT&#39;s of the raw, clean, and noise</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">removed_noise</span> <span class="o">=</span> <span class="n">raw_image</span> <span class="o">-</span> <span class="n">clean_image</span>
    <span class="n">blackman_window_rows</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">blackman</span><span class="p">(</span><span class="n">clean_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">blackman_window_cols</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">blackman</span><span class="p">(</span><span class="n">clean_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">FFT_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">blackman_window_rows</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">raw_image</span> <span class="o">*</span> <span class="n">blackman_window_cols</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]),</span>
        <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="n">FFT_clean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">blackman_window_rows</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">clean_image</span> <span class="o">*</span> <span class="n">blackman_window_cols</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]),</span>
        <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="n">FFT_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">blackman_window_rows</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">removed_noise</span> <span class="o">*</span> <span class="n">blackman_window_cols</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]),</span>
        <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Now find the mean and standard deviation of the images</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">raw_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">raw_image</span><span class="p">)</span>
    <span class="n">clean_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">clean_image</span><span class="p">)</span>
    <span class="n">noise_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">removed_noise</span><span class="p">)</span>

    <span class="n">raw_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">raw_image</span><span class="p">)</span>
    <span class="n">clean_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">clean_image</span><span class="p">)</span>
    <span class="n">noise_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">removed_noise</span><span class="p">)</span>
    <span class="n">fft_clean_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">FFT_clean</span><span class="p">)</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Make lists of everything needed to plot</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">plot_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="s1">&#39;Cleaned Image&#39;</span><span class="p">,</span> <span class="s1">&#39;Removed Noise&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;FFT Original Image&#39;</span><span class="p">,</span> <span class="s1">&#39;FFT Cleaned Image&#39;</span><span class="p">,</span> <span class="s1">&#39;FFT Removed Noise&#39;</span><span class="p">]</span>
    <span class="n">plot_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">raw_image</span><span class="p">,</span> <span class="n">clean_image</span><span class="p">,</span> <span class="n">removed_noise</span><span class="p">,</span> <span class="n">FFT_raw</span><span class="p">,</span> <span class="n">FFT_clean</span><span class="p">,</span> <span class="n">FFT_noise</span><span class="p">]</span>
    <span class="n">plot_mins</span> <span class="o">=</span> <span class="p">[</span><span class="n">raw_mean</span> <span class="o">-</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">raw_std</span><span class="p">,</span> <span class="n">clean_mean</span> <span class="o">-</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">clean_std</span><span class="p">,</span> <span class="n">noise_mean</span> <span class="o">-</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">noise_std</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">plot_maxes</span> <span class="o">=</span> <span class="p">[</span><span class="n">raw_mean</span> <span class="o">+</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">raw_std</span><span class="p">,</span> <span class="n">clean_mean</span> <span class="o">+</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">clean_std</span><span class="p">,</span> <span class="n">noise_mean</span> <span class="o">+</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">noise_std</span><span class="p">,</span>
                  <span class="mi">2</span> <span class="o">*</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">fft_clean_std</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">fft_clean_std</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">stdevs</span> <span class="o">*</span> <span class="n">fft_clean_std</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">plot_min</span><span class="p">,</span> <span class="n">plot_max</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">axes_clean</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span>
                                                           <span class="n">plot_names</span><span class="p">,</span> <span class="n">plot_mins</span><span class="p">,</span> <span class="n">plot_maxes</span><span class="p">):</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">plot_map</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">stdevs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">plot_min</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">plot_max</span><span class="p">)</span>
        <span class="n">axes_clean</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">plot_args</span><span class="p">[</span><span class="s1">&#39;sub_title_size&#39;</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">axes_clean</span><span class="o">.</span><span class="n">cbar_axes</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">plot_args</span><span class="p">[</span><span class="s1">&#39;cbar_tick_font_size&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">plot_args</span><span class="p">[</span><span class="s1">&#39;show_x_y_ticks&#39;</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">plot_args</span><span class="p">[</span><span class="s1">&#39;show_tick_marks&#39;</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig_clean</span><span class="p">,</span> <span class="n">axes_clean</span></div>


<div class="viewcode-block" id="save_fig_filebox_button"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.save_fig_filebox_button">[docs]</a><span class="k">def</span> <span class="nf">save_fig_filebox_button</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create ipython widgets to allow the user to save a figure to the</span>
<span class="sd">    specified file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fig : matplotlib.Figure</span>
<span class="sd">        The figure to be saved.</span>
<span class="sd">    filename : str</span>
<span class="sd">        The filename the figure should be saved to</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    widget_box : ipywidgets.HBox</span>
<span class="sd">        Widget box holding the text entry and save button</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">file_dir</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="n">name_box</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                            <span class="n">placeholder</span><span class="o">=</span><span class="s1">&#39;Type something&#39;</span><span class="p">,</span>
                            <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Output Filename:&#39;</span><span class="p">,</span>
                            <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">layout</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;50%&#39;</span><span class="p">})</span>
    <span class="n">save_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Save figure&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_save_fig</span><span class="p">():</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">save_fig</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="s1">&#39;figure&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Figure saved to &quot;</span><span class="si">{}</span><span class="s1">&quot;.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">save_path</span><span class="p">))</span>

    <span class="n">widget_box</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">name_box</span><span class="p">,</span> <span class="n">save_button</span><span class="p">])</span>

    <span class="n">save_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">_save_fig</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">widget_box</span></div>


<div class="viewcode-block" id="export_fig_data"><a class="viewcode-back" href="../../../_autosummary/_autosummary/pycroscopy.viz.plot_utils.html#pycroscopy.viz.plot_utils.export_fig_data">[docs]</a><span class="k">def</span> <span class="nf">export_fig_data</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">include_images</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export the data of all plots in the figure `fig` to a plain text file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fig : matplotlib.figure.Figure</span>
<span class="sd">        The figure containing the data to be exported</span>
<span class="sd">    filename : str</span>
<span class="sd">        The filename of the output text file</span>
<span class="sd">    include_images : bool</span>
<span class="sd">        Should images in the figure also be exported</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the data from the figure</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()</span>
    <span class="n">axes_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">ax_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="n">ims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_images</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ims</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">include_images</span><span class="p">:</span>
            <span class="n">im_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">im</span> <span class="ow">in</span> <span class="n">ims</span><span class="p">:</span>
                <span class="c1"># Image data</span>
                <span class="n">im_lab</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
                <span class="n">im_dict</span><span class="p">[</span><span class="n">im_lab</span><span class="p">]</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>

                <span class="c1"># X-Axis</span>
                <span class="n">x_ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span>
                <span class="n">x_lab</span> <span class="o">=</span> <span class="n">x_ax</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">x_lab</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">x_lab</span> <span class="o">=</span> <span class="s1">&#39;X&#39;</span>

                <span class="n">im_dict</span><span class="p">[</span><span class="n">im_lab</span> <span class="o">+</span> <span class="n">x_lab</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_ax</span><span class="o">.</span><span class="n">get_data_interval</span><span class="p">()</span>

                <span class="c1"># Y-Axis</span>
                <span class="n">y_ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span>
                <span class="n">y_lab</span> <span class="o">=</span> <span class="n">y_ax</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">y_lab</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">y_lab</span> <span class="o">=</span> <span class="s1">&#39;Y&#39;</span>

                <span class="n">im_dict</span><span class="p">[</span><span class="n">im_lab</span> <span class="o">+</span> <span class="n">y_lab</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_ax</span><span class="o">.</span><span class="n">get_data_interval</span><span class="p">()</span>

            <span class="n">ax_dict</span><span class="p">[</span><span class="s1">&#39;Images&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">im_dict</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">line_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

            <span class="n">xlab</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlabel</span><span class="p">()</span>
            <span class="n">ylab</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">xlab</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">xlab</span> <span class="o">=</span> <span class="s1">&#39;X Data&#39;</span>
            <span class="k">if</span> <span class="n">ylab</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">ylab</span> <span class="o">=</span> <span class="s1">&#39;Y Data&#39;</span>

            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                <span class="n">line_dict</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">get_label</span><span class="p">()]</span> <span class="o">=</span> <span class="p">{</span><span class="n">xlab</span><span class="p">:</span> <span class="n">line</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(),</span>
                                               <span class="n">ylab</span><span class="p">:</span> <span class="n">line</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()}</span>

            <span class="n">ax_dict</span><span class="p">[</span><span class="s1">&#39;Lines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">line_dict</span>

        <span class="k">if</span> <span class="n">ax_dict</span> <span class="o">!=</span> <span class="nb">dict</span><span class="p">():</span>
            <span class="n">axes_dict</span><span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">get_title</span><span class="p">()]</span> <span class="o">=</span> <span class="n">ax_dict</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Now that we have the data from the figure, we need to write it to file.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">basename</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">folder</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>

    <span class="n">spacer</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;**********************************************\n&#39;</span>

    <span class="n">data_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

    <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax_lab</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Axis: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ax_lab</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">im_lab</span><span class="p">,</span> <span class="n">im</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">[</span><span class="s1">&#39;Images&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Image: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">im_lab</span><span class="p">))</span>
            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">im_data</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">im_data</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">tofile</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">im</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="n">val</span><span class="o">.</span><span class="n">tofile</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">spacer</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">line_lab</span><span class="p">,</span> <span class="n">line_dict</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">[</span><span class="s1">&#39;Lines&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Line: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">line_lab</span><span class="p">))</span>
            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span> <span class="o">=</span> <span class="n">line_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">val1</span><span class="p">,</span> <span class="n">val2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">line_dict</span><span class="p">[</span><span class="n">dim1</span><span class="p">],</span> <span class="n">line_dict</span><span class="p">[</span><span class="n">dim2</span><span class="p">]):</span>
                <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">val1</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">val2</span><span class="p">)))</span>

            <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">spacer</span><span class="p">)</span>

        <span class="n">data_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">spacer</span><span class="p">)</span>

    <span class="n">data_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span></div>
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Suhas Somnath, Chris Smith, Stephen Jesse, Numan Laanait.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'0.59.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>